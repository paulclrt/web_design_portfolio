<!DOCTYPE html>
<html lang="fr">
<head>
    <!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-MLCYZ1755W"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-MLCYZ1755W');
</script>
<!-- Google Tag Manager -->
<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
    new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
    j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
    'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
    })(window,document,'script','dataLayer','GTM-52RQ5RM7');</script>
    <!-- End Google Tag Manager -->
    <meta name="google-adsense-account" content="ca-pub-7151663009293026">
    <meta charset="UTF-8">
    <link rel="stylesheet" href="./css/styles.css">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="icon" type="image/x-icon" href="/archive/paulclaretpro/assets/favico.svg">
    <link rel="stylesheet" href="/archive/paulclaretpro/assets/css/navbar.css">
    <title>Les réseaux de neurones convolutionels | Blog Paul Claret</title>
    <meta name="description" content="Explication complète, étape par étape des réseaux de neurones convolutionels pour l'IA">
    

    <link defer rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.css" integrity="sha384-nB0miv6/jRmo5UMMR1wu3Gz6NLsoTkbqJghGIsx//Rlm+ZU03BU6SQNC66uf4l5+" crossorigin="anonymous">
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.js" integrity="sha384-7zkQWkzuo3B5mTepMUcHkMB5jZaolc2xDwL6VFqjFALcbeS9Ggm/Yr2r3Dy4lfFg" crossorigin="anonymous"></script>
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/contrib/auto-render.min.js" integrity="sha384-43gviWU0YVjaDtb/GhzOouOXtZMP/7XUzwPTstBeZFe/+rCMvRwr4yROQP43s0Xk" crossorigin="anonymous"
    onload="renderMathInElement(document.body);"></script>

    <link loading="lazy" class="blog-sheets" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.23.0/themes/prism.min.css" rel="stylesheet" />
    <script loading="lazy" class="blog-sheets" src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.23.0/prism.min.js"></script>
</head>

<body>

    <header>
        <div class="navbar">
            <a href="/archive/paulclaretpro/" class="image-link">
                <img src="/archive/paulclaretpro/assets/favico.svg" alt="Website Paul Claret Logo" >
            </a>
            <!-- <div class="desktop-links">
                <a href="/archive/paulclaretpro/">Home</a>
                <a href="/archive/paulclaretpro/blog">Blogs</a>
            </div> -->
            <div class="searchbar">
                <form action="/archive/paulclaretpro/blog/search.html" method="get">
                    <input type="text" name="q" placeholder="Search...">
                    <input type="submit">
                </form>
            </div>
        </div>
    </header>



    <main>
        <section class="redaction">
            <div id="ariane">
                <p>
                    <a href="/archive/paulclaretpro/blog/search.html">blog</a>
                    >
                    <a href="/archive/paulclaretpro/blog/les-reseaux-de-neurones-convolutionels.html">les-reseaux-de-neurones-convolutionels</a>
                </p>
            </div>
            <h1 class="title">Les réseaux de neurones convolutionels - CNN</h1>
            <h2 class="subtitle">Explicaitons simples puis approfondies avec les maths</h2>
            <div class="by-card">
                <img src="/archive/paulclaretpro/assets/favico.svg" alt="Author Profile - Paul Claret">
                <div>
                    <h3>By Paul Claret</h3>
                    <p>10 minutes read - 03/12/24</p>
                </div>
            </div>
           


            <p>Il existes différents réseaux de neurones pour différentes applications. Aussi simple que cela. Certains fonctionnement mieux avec des données textuelles, audios... Aujourd'hui je vous parle des réseaux de neurones qui fonctionnent le mieux sur les images. Les Convulutional Neural Network ou CNN pour la faire court.</p>
            <h2 class="atx" id="le-principe">Le principe</h2>
            <p>Pour nous humain, il est facile de reconnaitre un chat avec une image. Si je vous donnes les images ci dessous, quand bien même elles sont différentes, vous voyez toujours le chat, bien qu'il soit d'un angle différent, une limuière différente et parfois partiellement visible.</p>
            
            <style>
                .cats {
                    display: flex;
                    flex-direction: row;
                    justify-content: center;
                }
                .cats img {
                    max-width: 33%;
                }
            </style>
            <div class="cats">
                <img alt="Cats Hiding image" src="https://www.cats.org.uk/media/1128/cats-hiding-adbox.jpg">
                <img alt="Cat in the dark" src="https://catevolution.com.au/cdn/shop/articles/can_cat_see_in_the_dark-1200x750.jpg?v=1654801568&amp;width=1100">
                <img alt="Picture of sloppy cat" src="https://www.cuteness.com/cuteness/mlt80bd06b84571468f9f98cbb6c1bed97a.jpg">
            </div>

            <p>Ce n'est pas aussi simple pour un ordinateur. Si je vous affiche la représentation de ces iamges comme un ordinateur les voit, voilà à quoi ça ressemble:</p>
            <img src="/archive/paulclaretpro/blog/designs/where-is-the-cat.png" alt="matrice du chat">
            <p>Alors, il est où le chat ?</p>
            <p>Pour qu'un ordinateur puisse reconnaitre des objets dans des images, nous n'allons pas utiliser une réseaux de neurone classique comme nous l'avons vu précédement mais avec des filtres qui analyzent des parties de l'image partie après partie.</p>
            <h2 class="atx" id="le-reseaux">Le réseaux</h2>
            <p><img alt="" src="/archive/paulclaretpro/blog/designs/reseaux-cnn-overview.png"></p>
            <p>L'image ci dessus résume entièrement le principe d'un CNN. Nous avons notre image de chat en entrée et on va appliquer un filtre que l'on appèle kernel. Ce kernel (présent au dessus de notre image) contient des poids (tout comme pour les réseaux de neurones artificiel simples). Ces poids sont ensuite multiplié aux pixels de notre image et nous donne une seule valeurs en sortie (vous verrezplus loin l'application manuelle comment la multiplication marche).</p>
            <p>Après avoir passé notre kernel sur toute notre iamge, nous obtenons alors une nouvelle image que l'on appel conv (ce sont "les sorties des neurones d'un cnn"). Vous voyez, que l'on a 3 layers de conv 1.</p>
            <h3 class="atx" id="petit-rappel-sur-ce-que-sont-les-images">Petit rappel sur ce que sont les images</h3>
            <p>Les images sont des matrice qui contiennent des valeurs de pixel rouge, vert et bleu. Chaque pixel présent sur votre écran contient 3 LED: une rouge, une verte et une bleu.</p>
            <p><img alt="File:Liquid Crystal Display Macro Example zoom 3.jpg - Wikimedia Commons" src="https://upload.wikimedia.org/wikipedia/commons/thumb/6/6c/Liquid_Crystal_Display_Macro_Example_zoom_3.jpg/272px-Liquid_Crystal_Display_Macro_Example_zoom_3.jpg"></p>
            <p>A l'oeil nu, ces leds ne sont pas distinguable mais physiquement si vous vous rappelez de votre cours de physique au lycée, vous savez qu'en additionant ces trois couleurs, vous pouvez obtenir n'importe quel couleur sous l'arc en ciel. Si vous voulez avoir  un pixel rouge, il faut allumer seulement la led rouge et éteindre les deux autres etc. Vous savez probablement déjà tout ça.</p>
            <p>Donc une image est une carte composé de 3 couches qui indique à quels points les rouges doivent être activées, à quel point les bleus doivent l'être... Cela nous donne donc 3 matrices qui forment une image. Voici un example:</p>
            <p><img alt="IMage RGB.png" src="/archive/paulclaretpro/blog/designs/imageRGB.png"></p>
            <h2 class="atx" id="le-nombre-de-couches-de-convolution">Le nombre de couches de convolution</h2>
            <p>Le nombre de couche de convolution que vous allez sortir de votre image est comlétement arbitraire et à vous de le decider.</p>
            <p>Vous aller appliquer un kernel de taille YxYxZ avec Z la profondeur de l'image. regardez l'image ci dessous:</p>
            <p><img alt="filtre a convolution exemple" src="/archive/paulclaretpro/blog/designs/filtre-convolution.png"></p>
            <p>En entrée, nous avons une aimge de taille 32x32 (avec la profondeur de 3 puisque c'est une iamge RGB comme expliqué précedement). Nous passons notre filtre de taille 5x5 et profondeur 3  sur toute notre image pour sortir une carte d'activation. C'est ce que j'ai appelé les conv 1 et  conv 2.</p>
            <p>Pour avoir 3 couches de convolution en sortie il suffit de passer 3 filtres différents sur notre image.</p>
            <p>En règle générale, plus vous avez un grand nombre de couche en sortie plus votre model va comprendre différentes particularités de l'image mais plus il va être gros et consomer des ressources.</p>
            <p><strong>Attention ! Les CNN peuvent vite devenir très gros et consomer toutes vos ressources ! Soyez méticuleux dans le choix de la taille de vos kernel, images, et nombre de layer.</strong> En règle générale, c'est bien de commencer par des tailles petites comme 3x3 et mettre entre 3 à 12 couches max. J'ai écris un autre article sur le choix des tailles des matrices... et les calculs de ressources nécéssaire ici: <a href="">Bien définir l'architecture de votre réseaux de neurones CNN-RNN-etc</a></p>
            <h2 class="atx" id="le-pooling">Le pooling</h2>
            <p>Après avoir obtenu nos couche de convolution, nous allons maintenant appliquer ce que l'on appèle le pooling. C'est la même chose que pour les fonctions d'activation mais pour les images. plutôt que de garder une image très grande à chaque couche, nous allons la simplifier avec une fonction qui va prendre les pixels les plus importants et se débarasser des autres.</p>
            <p>Généralement, il y a deux fonctions utilisés: maxpool et avgpool.</p>
            <p>Le maxpool, comme son nom l'indique, prend la valeur maximale parmis une partie de l'image et jette les autres. Le avgpool ou average pool quant à lui, prend les moyenne de chaque pixel et garde cette valeur. Vous choisissez celle que vous voulez.</p>
            <p>Voici une image résumant très bien le principe des deux fonctions:</p>
            <p><img alt="Max pooling and average pooling in ConvNet" src="https://cdn.analyticsvidhya.com/wp-content/uploads/2024/08/597371-kqieqhxzicu7thjaqbfpbq-66c7045e59b1e.webp"></p>
            <p>Comme vous pouvez le voir, le kernel de ce pooling layer, est de taille 2x2. On commence en haut à gauche et regarde la matrice</p>
            <span class="katex-display"><span class="katex"><span class="katex-mathml"></span><span aria-hidden="true" class="katex-html"><span class="base"><span style="height:2.4em;vertical-align:-0.95em;" class="strut"></span><span class="minner"><span style="top:0em;" class="mopen delimcenter"><span class="delimsizing size3">[</span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span style="height:1.45em;" class="vlist"><span style="top:-3.61em;"><span style="height:3em;" class="pstrut"></span><span class="mord"><span class="mord">12</span></span></span><span style="top:-2.41em;"><span style="height:3em;" class="pstrut"></span><span class="mord"><span class="mord">8</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span style="height:0.95em;" class="vlist"><span></span></span></span></span></span><span style="width:0.5em;" class="arraycolsep"></span><span style="width:0.5em;" class="arraycolsep"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span style="height:1.45em;" class="vlist"><span style="top:-3.61em;"><span style="height:3em;" class="pstrut"></span><span class="mord"><span class="mord">20</span></span></span><span style="top:-2.41em;"><span style="height:3em;" class="pstrut"></span><span class="mord"><span class="mord">12</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span style="height:0.95em;" class="vlist"><span></span></span></span></span></span></span></span><span style="top:0em;" class="mclose delimcenter"><span class="delimsizing size3">]</span></span></span></span></span></span></span><p>On prend la plus grande valeur dans cette matrice et on la met en haut à gauche de la matrice de pooling. on déplace ensuite le kernel sur les pixels suivants et on prend la plus grande valeur:</p>
            <span class="katex-display"><span class="katex"><span class="katex-mathml"></span><span aria-hidden="true" class="katex-html"><span class="base"><span style="height:2.4em;vertical-align:-0.95em;" class="strut"></span><span class="minner"><span style="top:0em;" class="mopen delimcenter"><span class="delimsizing size3">[</span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span style="height:1.45em;" class="vlist"><span style="top:-3.61em;"><span style="height:3em;" class="pstrut"></span><span class="mord"><span class="mord">30</span></span></span><span style="top:-2.41em;"><span style="height:3em;" class="pstrut"></span><span class="mord"><span class="mord">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span style="height:0.95em;" class="vlist"><span></span></span></span></span></span><span style="width:0.5em;" class="arraycolsep"></span><span style="width:0.5em;" class="arraycolsep"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span style="height:1.45em;" class="vlist"><span style="top:-3.61em;"><span style="height:3em;" class="pstrut"></span><span class="mord"><span class="mord">0</span></span></span><span style="top:-2.41em;"><span style="height:3em;" class="pstrut"></span><span class="mord"><span class="mord">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span style="height:0.95em;" class="vlist"><span></span></span></span></span></span></span></span><span style="top:0em;" class="mclose delimcenter"><span class="delimsizing size3">]</span></span></span><span style="margin-right:0.2778em;" class="mspace"></span><span class="mrel">→</span><span style="margin-right:0.2778em;" class="mspace"></span></span><span class="base"><span style="height:0.6444em;" class="strut"></span><span class="mord">30</span></span></span></span></span><p>On continu jusqu'à ce que l'on ai parcouru toute la matrice de convolution.</p>
            <p>Je vous laisse faire les calculs si vous souhaitez experimenter avec le average pool.</p>
            <h2 class="atx" id="et-on-recommence-">Et on recommence !</h2>
            <p>Une chose que j'ai oublié de mentioner est que les pooling layer sont seulement de taille profondeur 1. C'est à dire qu'il y a autant de pooling layer que de couche de convolution en entrée. Si vous regardez le schéma du début, vous remarquerez que chaque pool a autant de couche que les convolution précédentes.</p>
            <p>Maintenant que l'on a nos couche de pooling calculées, on réapplique une couche de convolution et encore une de pooling. On met autant de couche de convolution et pooling que l'on veut. On peut même mettre plusieurs couche de convolution les unes après les autres sans pooling entre. Vous être libre de créer l'architecture que vous voulez. Pour vous donner une idée d'une architecture faite par un expert en IA. Je vous présente le réseaux AlexNet. Créé par les meilleurs chercheurs et ingénieurs en IA de nos jours: <a title="Alex Krizhevsky" href="https://en.wikipedia.org/wiki/Alex_Krizhevsky">Alex Krizhevsky</a>,&nbsp;<a title="Ilya Sutskever" href="https://en.wikipedia.org/wiki/Ilya_Sutskever">Ilya Sutskever</a>&nbsp;et <a href="https://en.wikipedia.org/wiki/Geoffrey_Hinton">Geoffrey Hinton</a></p>
            <p><img style="max-height: 50vh;" alt="undefined" src="https://upload.wikimedia.org/wikipedia/commons/thumb/a/ad/AlexNet_block_diagram.svg/1024px-AlexNet_block_diagram.svg.png"> <br>Architecture AlexNet</p>
            <p>En bonus, voici l'architecture VGG-16:</p>
            <p><img alt="How to Maximize CNN Performance with Proper Padding and Stride Selection |  by Waseem Kathia | Medium" src="https://miro.medium.com/v2/resize:fit:800/1*Vg5d-fM-nOwyd3fOs6_1dw.jpeg"></p>
            <h2 class="atx" id="la-couche-de-convolution-dans-le-detail">La couche de convolution dans le détail</h2>
            <p>Si vous avez bien regardé l'architecture AlexNet, vous avez remarqué qu'il a des mots que l'on a pas encore abordé: stride, pad. 🤔</p>
            <p>Pour vous l'expliquer, j'ai besoins de plonger dans le détail du calcul de la couche de convolution.</p>
            <p>Je vous ai expliqué que l'on passait un kernel sur notre image et en sortait un nombre sans plus de détails. Je trouve personellement qu'un gif vaut mieux que 1000 mots pour l'expliquer donc voici le calcul de la convolution:</p>
            <p><img alt="Grayscale image | Computer vision | CNN" src="https://cdn.analyticsvidhya.com/wp-content/uploads/2024/08/unnamed-1-66c705a22fa6a.webp"></p>
            <p>Ici on a simplifié le calcul sur une couche en mettant que des 0 et 1. On commence comme pour le pooling en haut à gauche de notre image (input data). On le multiplie par notre kernel et additionne le résultat.  <strong>Attention, ce n'est pas une multiplication de matrice comme en maths</strong>:</p>
            <span class="katex-display"><span class="katex"><span class="katex-mathml"></span><span aria-hidden="true" class="katex-html"><span class="base"><span style="height:3.6em;vertical-align:-1.55em;" class="strut"></span><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span style="height:2.05em;" class="vlist"><span style="top:-2.25em;"><span style="height:3.155em;" class="pstrut"></span><span class="delimsizinginner delim-size4"><span>⎣</span></span></span><span style="top:-3.397em;"><span style="height:3.155em;" class="pstrut"></span><span style="height:0.016em;width:0.6667em;"><svg preserveAspectRatio="xMinYMin" viewBox="0 0 666.67 16" style="width:0.6667em" height="0.016em" width="0.6667em" xmlns="http://www.w3.org/2000/svg"><path d="M319 0 H403 V16 H319z M319 0 H403 V16 H319z"></path></svg></span></span><span style="top:-4.05em;"><span style="height:3.155em;" class="pstrut"></span><span class="delimsizinginner delim-size4"><span>⎡</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span style="height:1.55em;" class="vlist"><span></span></span></span></span></span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span style="height:2.05em;" class="vlist"><span style="top:-4.21em;"><span style="height:3em;" class="pstrut"></span><span class="mord"><span class="mord">1</span></span></span><span style="top:-3.01em;"><span style="height:3em;" class="pstrut"></span><span class="mord"><span class="mord">0</span></span></span><span style="top:-1.81em;"><span style="height:3em;" class="pstrut"></span><span class="mord"><span class="mord">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span style="height:1.55em;" class="vlist"><span></span></span></span></span></span><span style="width:0.5em;" class="arraycolsep"></span><span style="width:0.5em;" class="arraycolsep"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span style="height:2.05em;" class="vlist"><span style="top:-4.21em;"><span style="height:3em;" class="pstrut"></span><span class="mord"><span class="mord">1</span></span></span><span style="top:-3.01em;"><span style="height:3em;" class="pstrut"></span><span class="mord"><span class="mord">1</span></span></span><span style="top:-1.81em;"><span style="height:3em;" class="pstrut"></span><span class="mord"><span class="mord">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span style="height:1.55em;" class="vlist"><span></span></span></span></span></span><span style="width:0.5em;" class="arraycolsep"></span><span style="width:0.5em;" class="arraycolsep"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span style="height:2.05em;" class="vlist"><span style="top:-4.21em;"><span style="height:3em;" class="pstrut"></span><span class="mord"><span class="mord">1</span></span></span><span style="top:-3.01em;"><span style="height:3em;" class="pstrut"></span><span class="mord"><span class="mord">1</span></span></span><span style="top:-1.81em;"><span style="height:3em;" class="pstrut"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span style="height:1.55em;" class="vlist"><span></span></span></span></span></span></span></span><span class="mclose"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span style="height:2.05em;" class="vlist"><span style="top:-2.25em;"><span style="height:3.155em;" class="pstrut"></span><span class="delimsizinginner delim-size4"><span>⎦</span></span></span><span style="top:-3.397em;"><span style="height:3.155em;" class="pstrut"></span><span style="height:0.016em;width:0.6667em;"><svg preserveAspectRatio="xMinYMin" viewBox="0 0 666.67 16" style="width:0.6667em" height="0.016em" width="0.6667em" xmlns="http://www.w3.org/2000/svg"><path d="M263 0 H347 V16 H263z M263 0 H347 V16 H263z"></path></svg></span></span><span style="top:-4.05em;"><span style="height:3.155em;" class="pstrut"></span><span class="delimsizinginner delim-size4"><span>⎤</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span style="height:1.55em;" class="vlist"><span></span></span></span></span></span></span></span><span style="margin-right:0.1667em;" class="mspace"></span><span class="mord">.</span><span style="margin-right:0.1667em;" class="mspace"></span><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span style="height:2.05em;" class="vlist"><span style="top:-2.25em;"><span style="height:3.155em;" class="pstrut"></span><span class="delimsizinginner delim-size4"><span>⎣</span></span></span><span style="top:-3.397em;"><span style="height:3.155em;" class="pstrut"></span><span style="height:0.016em;width:0.6667em;"><svg preserveAspectRatio="xMinYMin" viewBox="0 0 666.67 16" style="width:0.6667em" height="0.016em" width="0.6667em" xmlns="http://www.w3.org/2000/svg"><path d="M319 0 H403 V16 H319z M319 0 H403 V16 H319z"></path></svg></span></span><span style="top:-4.05em;"><span style="height:3.155em;" class="pstrut"></span><span class="delimsizinginner delim-size4"><span>⎡</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span style="height:1.55em;" class="vlist"><span></span></span></span></span></span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span style="height:2.05em;" class="vlist"><span style="top:-4.21em;"><span style="height:3em;" class="pstrut"></span><span class="mord"><span class="mord">1</span></span></span><span style="top:-3.01em;"><span style="height:3em;" class="pstrut"></span><span class="mord"><span class="mord">0</span></span></span><span style="top:-1.81em;"><span style="height:3em;" class="pstrut"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span style="height:1.55em;" class="vlist"><span></span></span></span></span></span><span style="width:0.5em;" class="arraycolsep"></span><span style="width:0.5em;" class="arraycolsep"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span style="height:2.05em;" class="vlist"><span style="top:-4.21em;"><span style="height:3em;" class="pstrut"></span><span class="mord"><span class="mord">0</span></span></span><span style="top:-3.01em;"><span style="height:3em;" class="pstrut"></span><span class="mord"><span class="mord">1</span></span></span><span style="top:-1.81em;"><span style="height:3em;" class="pstrut"></span><span class="mord"><span class="mord">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span style="height:1.55em;" class="vlist"><span></span></span></span></span></span><span style="width:0.5em;" class="arraycolsep"></span><span style="width:0.5em;" class="arraycolsep"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span style="height:2.05em;" class="vlist"><span style="top:-4.21em;"><span style="height:3em;" class="pstrut"></span><span class="mord"><span class="mord">1</span></span></span><span style="top:-3.01em;"><span style="height:3em;" class="pstrut"></span><span class="mord"><span class="mord">0</span></span></span><span style="top:-1.81em;"><span style="height:3em;" class="pstrut"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span style="height:1.55em;" class="vlist"><span></span></span></span></span></span></span></span><span class="mclose"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span style="height:2.05em;" class="vlist"><span style="top:-2.25em;"><span style="height:3.155em;" class="pstrut"></span><span class="delimsizinginner delim-size4"><span>⎦</span></span></span><span style="top:-3.397em;"><span style="height:3.155em;" class="pstrut"></span><span style="height:0.016em;width:0.6667em;"><svg preserveAspectRatio="xMinYMin" viewBox="0 0 666.67 16" style="width:0.6667em" height="0.016em" width="0.6667em" xmlns="http://www.w3.org/2000/svg"><path d="M263 0 H347 V16 H263z M263 0 H347 V16 H263z"></path></svg></span></span><span style="top:-4.05em;"><span style="height:3.155em;" class="pstrut"></span><span class="delimsizinginner delim-size4"><span>⎤</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span style="height:1.55em;" class="vlist"><span></span></span></span></span></span></span></span><span style="margin-right:0.2778em;" class="mspace"></span><span class="mrel">=</span><span style="margin-right:0.2778em;" class="mspace"></span></span><span class="base"><span style="height:3.6em;vertical-align:-1.55em;" class="strut"></span><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span style="height:2.05em;" class="vlist"><span style="top:-2.25em;"><span style="height:3.155em;" class="pstrut"></span><span class="delimsizinginner delim-size4"><span>⎣</span></span></span><span style="top:-3.397em;"><span style="height:3.155em;" class="pstrut"></span><span style="height:0.016em;width:0.6667em;"><svg preserveAspectRatio="xMinYMin" viewBox="0 0 666.67 16" style="width:0.6667em" height="0.016em" width="0.6667em" xmlns="http://www.w3.org/2000/svg"><path d="M319 0 H403 V16 H319z M319 0 H403 V16 H319z"></path></svg></span></span><span style="top:-4.05em;"><span style="height:3.155em;" class="pstrut"></span><span class="delimsizinginner delim-size4"><span>⎡</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span style="height:1.55em;" class="vlist"><span></span></span></span></span></span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span style="height:2.05em;" class="vlist"><span style="top:-4.21em;"><span style="height:3em;" class="pstrut"></span><span class="mord"><span class="mord">1.1</span></span></span><span style="top:-3.01em;"><span style="height:3em;" class="pstrut"></span><span class="mord"><span class="mord">0.0</span></span></span><span style="top:-1.81em;"><span style="height:3em;" class="pstrut"></span><span class="mord"><span class="mord">0.1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span style="height:1.55em;" class="vlist"><span></span></span></span></span></span><span style="width:0.5em;" class="arraycolsep"></span><span style="width:0.5em;" class="arraycolsep"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span style="height:2.05em;" class="vlist"><span style="top:-4.21em;"><span style="height:3em;" class="pstrut"></span><span class="mord"><span class="mord">1.0</span></span></span><span style="top:-3.01em;"><span style="height:3em;" class="pstrut"></span><span class="mord"><span class="mord">1.1</span></span></span><span style="top:-1.81em;"><span style="height:3em;" class="pstrut"></span><span class="mord"><span class="mord">0.0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span style="height:1.55em;" class="vlist"><span></span></span></span></span></span><span style="width:0.5em;" class="arraycolsep"></span><span style="width:0.5em;" class="arraycolsep"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span style="height:2.05em;" class="vlist"><span style="top:-4.21em;"><span style="height:3em;" class="pstrut"></span><span class="mord"><span class="mord">1.1</span></span></span><span style="top:-3.01em;"><span style="height:3em;" class="pstrut"></span><span class="mord"><span class="mord">1.0</span></span></span><span style="top:-1.81em;"><span style="height:3em;" class="pstrut"></span><span class="mord"><span class="mord">1.1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span style="height:1.55em;" class="vlist"><span></span></span></span></span></span></span></span><span class="mclose"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span style="height:2.05em;" class="vlist"><span style="top:-2.25em;"><span style="height:3.155em;" class="pstrut"></span><span class="delimsizinginner delim-size4"><span>⎦</span></span></span><span style="top:-3.397em;"><span style="height:3.155em;" class="pstrut"></span><span style="height:0.016em;width:0.6667em;"><svg preserveAspectRatio="xMinYMin" viewBox="0 0 666.67 16" style="width:0.6667em" height="0.016em" width="0.6667em" xmlns="http://www.w3.org/2000/svg"><path d="M263 0 H347 V16 H263z M263 0 H347 V16 H263z"></path></svg></span></span><span style="top:-4.05em;"><span style="height:3.155em;" class="pstrut"></span><span class="delimsizinginner delim-size4"><span>⎤</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span style="height:1.55em;" class="vlist"><span></span></span></span></span></span></span></span></span></span></span></span><p>Ici on prend chaque élément de matrice et les multiplie un a un. Càd que l'on commence en haut à gauche dans chaque matrice (1 et 1) et on les mutltiplie <span class="katex"><span class="katex-mathml"></span><span aria-hidden="true" class="katex-html"><span class="base"><span style="height:0.6444em;" class="strut"></span><span class="mord">1.1</span><span style="margin-right:0.2778em;" class="mspace"></span><span class="mrel">=</span><span style="margin-right:0.2778em;" class="mspace"></span></span><span class="base"><span style="height:0.6444em;" class="strut"></span><span class="mord">1</span></span></span></span>. On continue pour l'élément suivant (ligne 1 colonne 2: 1 et 0). On les multiplies: <span class="katex"><span class="katex-mathml"></span><span aria-hidden="true" class="katex-html"><span class="base"><span style="height:0.6444em;" class="strut"></span><span class="mord">1.0</span><span style="margin-right:0.2778em;" class="mspace"></span><span class="mrel">=</span><span style="margin-right:0.2778em;" class="mspace"></span></span><span class="base"><span style="height:0.6444em;" class="strut"></span><span class="mord">0</span></span></span></span>. On continu pour toute la matrice et on fini par additioner tous les élements de la matrice entre eux. </p>
            <p>Dans notre matrice le résultat vaut 4. Si vous regardez le résultat en haut à gauche de la matrice convoluted feature, on a un 4. L'exemple continue ensuite en prennant la partie du haute du milieux et ensuite la partie haute droite...</p>
            <p>On continue jusqu'à ce que la matrice soit pleine.</p>
            <p><img alt="Convolution process in Convolutional Neural Networks" src="/archive/paulclaretpro/blog/designs/convolution exemple.gif"></p>
            <h3 class="atx" id="le-stride">Le stride</h3>
            <p>Le stride est le pas entre chaque calcul de matrice. Dans tous les example précents, nous avons balayé la matrice avec notre kernel de pixel en pixel soit un stride de 1. Si nous sautons de 2 pixel  en 2 pixels, notre stride est de 2. </p>
            <p><img alt="Basics of CNN in Deep Learning - Analytics Vidhya" src="https://editor.analyticsvidhya.com/uploads/33383str.jpg"></p>
            <p>Sur l'image ci dessus, nous avons un kernel 3x3 et faison le même calcul que précédement à l'exception que comme vous pouvez le voir avec les couleurs, notre deuxième calcul est décalé de 2 pixels.</p>
            <p>Vous remarquez aussi que cela à une influence sur la taille de la sortie. Donc que se passe-t-il si l'on dépasse ntore input/on prend une stride trop grande ?</p>
            <p>C'est là que le pad à son importance.</p>
            <h3 class="atx" id="le-padding">Le padding</h3>
            <p>Pour fixer la règle, pour que votre taille de kernel et stride soient bon, il faut que la taill de l'entrée - la taille de votre kernel divisé par votre stride soit un nombre entier. 
            Voici la formule</p>
            <span class="katex-display"><span class="katex"><span class="katex-mathml"></span><span aria-hidden="true" class="katex-html"><span class="base"><span style="height:2.0574em;vertical-align:-0.686em;" class="strut"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span style="height:1.3714em;" class="vlist"><span style="top:-2.314em;"><span style="height:3em;" class="pstrut"></span><span class="mord"><span class="mord mathnormal">s</span><span class="mord mathnormal">t</span><span style="margin-right:0.02778em;" class="mord mathnormal">r</span><span class="mord mathnormal">i</span><span class="mord mathnormal">d</span><span class="mord mathnormal">e</span></span></span><span style="top:-3.23em;"><span style="height:3em;" class="pstrut"></span><span style="border-bottom-width:0.04em;" class="frac-line"></span></span><span style="top:-3.677em;"><span style="height:3em;" class="pstrut"></span><span class="mord"><span class="mord"><span class="mord mathnormal">in</span><span class="mord mathnormal">p</span><span class="mord mathnormal">u</span><span class="mord mathnormal">t</span></span><span style="margin-right:0.2222em;" class="mspace"></span><span class="mbin">−</span><span style="margin-right:0.2222em;" class="mspace"></span><span class="mord"><span style="margin-right:0.03148em;" class="mord mathnormal">k</span><span style="margin-right:0.02778em;" class="mord mathnormal">er</span><span class="mord mathnormal">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span style="height:0.686em;" class="vlist"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span><p>D'ailleur, la taille de la sortie sera:</p>
            <span class="katex-display"><span class="katex"><span class="katex-mathml"></span><span aria-hidden="true" class="katex-html"><span class="base"><span style="height:0.8778em;vertical-align:-0.1944em;" class="strut"></span><span style="margin-right:0.02778em;" class="mord mathnormal">O</span><span class="mord mathnormal">u</span><span class="mord mathnormal">tp</span><span class="mord mathnormal">u</span><span class="mord"><span class="mord mathnormal">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span style="height:0.3117em;" class="vlist"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span style="height:2.7em;" class="pstrut"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">s</span><span class="mord mathnormal mtight">i</span><span class="mord mathnormal mtight">ze</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span style="height:0.15em;" class="vlist"><span></span></span></span></span></span></span><span style="margin-right:0.2778em;" class="mspace"></span><span class="mrel">=</span><span style="margin-right:0.2778em;" class="mspace"></span></span><span class="base"><span style="height:2.0574em;vertical-align:-0.686em;" class="strut"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span style="height:1.3714em;" class="vlist"><span style="top:-2.314em;"><span style="height:3em;" class="pstrut"></span><span class="mord"><span class="mord mathnormal">s</span><span class="mord mathnormal">t</span><span style="margin-right:0.02778em;" class="mord mathnormal">r</span><span class="mord mathnormal">i</span><span class="mord mathnormal">d</span><span class="mord mathnormal">e</span></span></span><span style="top:-3.23em;"><span style="height:3em;" class="pstrut"></span><span style="border-bottom-width:0.04em;" class="frac-line"></span></span><span style="top:-3.677em;"><span style="height:3em;" class="pstrut"></span><span class="mord"><span class="mord mathnormal">in</span><span class="mord mathnormal">p</span><span class="mord mathnormal">u</span><span class="mord mathnormal">t</span><span style="margin-right:0.2222em;" class="mspace"></span><span class="mbin">−</span><span style="margin-right:0.2222em;" class="mspace"></span><span style="margin-right:0.03148em;" class="mord mathnormal">k</span><span style="margin-right:0.02778em;" class="mord mathnormal">er</span><span class="mord mathnormal">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span style="height:0.686em;" class="vlist"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span style="margin-right:0.2222em;" class="mspace"></span><span class="mbin">+</span><span style="margin-right:0.2222em;" class="mspace"></span></span><span class="base"><span style="height:0.6444em;" class="strut"></span><span class="mord">1</span></span></span></span></span><p>Alors comment faire si l'on veut une taille de kernel qui ne va pas avec le stride ? On rajotue des 0 en brodure de notre input.</p>
            <p><img alt="How Padding helps in CNN ?" src="/archive/paulclaretpro/blog/designs/padded iamge for cnn.webp"></p>
            <p>Combien de couche 0 faut-il ajouter ? Autant que nécéssaire pour que votre kernel et stride fonctionnenet avec votre image. Si vous vous voyez ajouter plus de 3 layer de padding, vous ferez mieux de changer de stride et kernel par contre.</p>
            <h2 class="atx" id="le-tout-en-un-gif-">Le tout en un GIF !</h2>
            <p>Pifou, j'ai rédigé tout cet article d'un coup et ça commence à être long. Mais au moins, vous avez vu tout ce qu'il y a à savoir sur les CNN pour déjà créer votre propre architectures !</p>
            <p>Alors voilà un gif qui résume tout:</p>
            <p><img alt="Working of ConvNet on RGB color images,convolutional neural networks" src="/archive/paulclaretpro/blog/designs/convolution_final.gif"></p>
            <p>Pour ce qui est la backpropagation, le principe est le même, on actualise les poids des kernel et des matrices de bias (oui il y en a. juste que c'est qu'une simple addition donc je l'ai pas mentioné).</p>
            <h2 class="atx" id="pour-finir-les-couches-fully-connected">Pour finir: les couches fully connected</h2>
            <p>Sur l'image des architectures, il y plusieurs couches FC connectés après toutes nos couches de convolution et pooling. Ces couches FC sont des réseaux de neurones artificiels simples comme vu dans les articles précédents.</p>
            <p>Ces couches servent souvent à prédire un label... tel que chiens ou chat. (La partie prédiciton de notre model quoi).</p>
            <p>Cependant, pour faire passer les données de dimensions 2D (pour les images) aux dimensions de l'ANN, il faut le faire passer dans une dimension 1. C'est le role du flatten layer. Il prend une matrice et la transforme en une ligne comme ceci:</p>
            <p><img alt="fully connected network" src="https://cdn.analyticsvidhya.com/wp-content/uploads/2020/02/Screenshot-from-2020-02-03-18-41-50.png"></p>
            <h2 class="atx" id="conclusion">Conclusion</h2>
            <p>Vous vous demandez surement est-ce que tout ça est pas bullshit ? Comment juste des matrices peuvent reconnaitre des animaux. Et bah voici un petit apperçu dans un model qui a été entrainé:</p>
            <p><img alt="5 layers of CNN | computer vision applications, convolutional neural networks" src="https://cdn.analyticsvidhya.com/wp-content/uploads/2024/10/image-152-1-1-1.webp"></p>
            <p>Vous voyez ici des cartes d'activation pour les images ) côté. Ces cartes d'activation (bien que peu visible avec la qualité de l'image), s'activent sur des zones tel que les bords, et diagonales...</p>
            <p>Tout celà permet au réseaux de neurones de reconnaitre des images. Si c'est pas fou.</p>
            <p>Je vous invite à regarder le tuto suivant ou je vais construire avec vous non pas 1 mais 2 réseaux de neurone artificiel pour prédire des chiffres écrit à la main et les cancers du cerveau. Oui oui on va prédire si des gens ont des tumeurs aux cerveaux avec une IA !</p>












            <h3> Vous voulez apprendre l'IA en autonomie ?</h3>
            <p>
                Si vous êtes nouveau sur mon site, je vous invite à aller voir ma page sur <a href="/archive/paulclaretpro/roadmap/ai-roadmap.html">Roadmap IA</a> qui regroupe tous mes articles dans l'ordre pour vous facilitez l'apprentissage.
            </p>
        </section>
    </main>




    <footer> 
        <p>
            Copyright © 2024 Paul Claret 
        </p> 
        <p>
            Made with Love ❤️
        </p> 
        <p>     
            <!-- <a href="/archive/paulclaretpro/tos" class="hover:underline"> Terms of Service </a> |
            <a href="/archive/paulclaretpro/privacy" class="hover:underline"> Privacy Policy </a> | -->
            <a href="mailto:paulclaret4@gmail.com" class="hover:underline"> Contact Me </a> 
        </p>
    </footer>



</body>
</html>